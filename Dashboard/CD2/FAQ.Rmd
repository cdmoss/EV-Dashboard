---
output: html_document
---

```{r echo = FALSE, message=FALSE, warning=FALSE, include=FALSE}
library(tidyverse)
library(knitr)
library(kableExtra)
df = read_csv("data.csv")
```

### Questions {.tabset}

#### Consumer {.tabset .tabset-dropdown}

##### How much does an e-golf cost?

A 2019 Volkswagen E-golf starts at $36,720.

##### How much does it cost to charge the e-golf?

```{r echo = FALSE, message=FALSE, warning=FALSE}
x = 41.55/655

df %>% 
  mutate(cost = power_usage * x,
         cost = scales::dollar(cost)) %>% 
  filter(power_usage == max(power_usage, na.rm = T)) %>% 
  select(cost, power_usage) %>% 
  kable()
```

##### What maintenance do electric vehicles require?

- Battery
- Brakes
- Tires

##### What features does the e-golf have (i.e. departure, maybe a broad question, we could split it up and instead ask how each feature works?)?




##### What type of warranty does the e-golf have?

Basic: 3 yrs/60,000 km
Battery: 8 yrs/160,000 km
Drive-Train: 5 yrs/100,000 km
Corrosion: 12 yrs/unlimited km
Roadside Assistance: 3 yrs/unlimited km 
Maintenance 2 yrs/40,000 km

##### What type of incentives come with owning an electric vehicle?

As per the iZEV program, the Canadian Federal Government will award rebates for the following amounts (pertaining to the 2019 VW E-golf):

 - \$5,000 for full purchase 
 - \$1,250 for a 12-month lease 
 - \$2,500 for a 24-month lease 
 - \$3,750 for a 36-month lease 
 
 ([list of vehicles eligible for the iZEV program](https://www.tc.gc.ca/en/services/road/innovative-technologies/list-eligible-vehicles-under-izev-program.html)).

#### Charging {.tabset .tabset-dropdown}

##### How long does it take to charge on average?

There are typically 3 levels of charger:

- Level 1 (120V): full charge takes 8 - 12hrs

- Level 2 (240V): full charge takes 4 - 6hrs

- Level 3 (480V): full charge takes 30min

##### What are the options for home charging stations and how much do they cost?

The E-golf comes with a 120V level 1 charger that is compatible with a standard 

##### Which chargers are compatible with the e-golf? How many are there?

J1772 - regular speed
CCS - fast charging

##### How much electricity does the e-golf use? Cost per KMs

```{r echo = FALSE, message=FALSE, warning=FALSE}
val = df %>% 
  mutate(cost = economy * x,
         cost = cost / 100) %>% 
  summarise(CostPerKm = mean(cost, na.rm = T) %>% scales::dollar()) %>% 
  pull(CostPerKm)
```
Average cost per Km is `r val`.

#### Driving {.tabset .tabset-dropdown}

##### What is the averge range of the vehicle?

```{r echo = FALSE, message=FALSE, warning=FALSE}
df %>% 
  group_by(Temperature = cut(start_outside_temp, 5)) %>% 
  summarise(`Max Range` = max(range_start, na.rm = T) %>% round(0)) %>% 
  drop_na %>%
  mutate(Temperature = Temperature %>% 
           str_remove("\\(") %>% 
           str_remove("\\]") %>% 
           str_replace("\\,", " to "))
```

##### What is regenerative braking? How do the different brake modes (D, D1, D2, D3, B) effect the driving experience of the vehicle? 

The e-golf, like all other electric vehicles, uses regenerative braking, a technology that slows the vehicle down using the electric motor instead of the breaks. As the vehicle is slowed down, the extra energy is fed back into the motor and charges the vehicle battery. The brake modes determine how the car will slow down when coasting.

##### How do the different drive modes effect the driving experience of the vehicle?



##### How fast is the e-golf?

df %>% 
  

##### How does temperature affect the performance of the vehicle (i.e. range, charge speed, etc.)?

```{r echo = FALSE, message=FALSE, warning=FALSE}

df %>% 
  ggplot(aes(x = start_outside_temp, y = range_start)) + 
  geom_point(alpha = 0.15) + 
  geom_smooth(method = "lm", se = F) + 
  theme_minimal() + 
  theme(panel.grid = element_blank()) + 
  labs(x = "Temperature", y = "Range")

```

According to our data (shown above), there is definately a postitive relationship between temperature and range. Boom!


##### What is blue score?
Blue score is......a.......

```{r echo = FALSE, message=FALSE, warning=FALSE}
df %>% 
  group_by(cut(average_speed, 5)) %>% 
  summarise(mean = mean(blue_score, na.rm = T)) %>% kable()
```



