---
output:
  html_document: default
  pdf_document: default
---

```{r echo = FALSE, message=FALSE, warning=FALSE, include=FALSE}
library(tidyverse)
library(knitr)
library(kableExtra)
df = read_csv("data.csv")
```

### Questions {.tabset}

#### Consumer {.tabset .tabset-fade .tabset-dropdown}

##### How much does an e-golf cost?

A 2019 Volkswagen E-golf starts at $36,720.

##### How much does it cost to charge the e-golf?

```{r echo = FALSE, message=FALSE, warning=FALSE}
x = 41.55/655

df %>% 
  mutate(cost = power_usage * x,
         cost = scales::dollar(cost)) %>% 
  filter(power_usage == max(power_usage, na.rm = T)) %>% 
  select(cost, power_usage) %>% 
  kable()
```
<br>
The Medicine Hat 2018 Utility rate was $41.55/655kWh.

Using this rate, the cost of charging from home is \$0.06/kWh, or \$2.15 for a full charge

##### What maintenance do electric vehicles require?

Electric vehicles don't require oil changes, fuel filter replacements, spark plug replacements or emission checks

##### What notable features does the e-golf have?

The e-golf has a list of great features:

- 

##### What type of warranty does the e-golf have?

- Basic: 3 yrs/60,000 km
- Battery: 8 yrs/160,000 km
- Drive-Train: 5 yrs/100,000 km
- Corrosion: 12 yrs/unlimited km
- Roadside Assistance: 3 yrs/unlimited km 
- Maintenance 2 yrs/40,000 km

##### What type of incentives come with owning an electric vehicle?

As per the iZEV program, the Canadian Federal Government will award rebates for the following amounts (pertaining to the 2019 VW E-golf):

 - \$5,000 for full purchase 
 - \$1,250 for a 12-month lease 
 - \$2,500 for a 24-month lease 
 - \$3,750 for a 36-month lease 
 
 ([list of vehicles eligible for the iZEV program](https://www.tc.gc.ca/en/services/road/innovative-technologies/list-eligible-vehicles-under-izev-program.html)).

#### Charging {.tabset .tabset-fade .tabset-dropdown}

##### How long does it take to charge on average?

There are typically 3 levels of charger:

- Level 1 (120V): full charge takes 8 - 12hrs

- Level 2 (240V): full charge takes 4 - 6hrs

- Level 3 (480V): full charge takes 30min

##### What are the options for home charging stations and how much do they cost?

The E-golf comes with a 120V level 1 charger that is compatible with a standard 

##### Which chargers are compatible with the e-golf? How many are there?

J1772 - regular speed
CCS - fast charging

##### How much electricity does the e-golf use? Cost per KMs

```{r echo = FALSE, message=FALSE, warning=FALSE}

x = 41.55/655

val = df %>% 
  mutate(cost = economy * x,
         cost = cost / 100) %>% 
  summarise(CostPerKm = mean(cost, na.rm = T) %>% scales::dollar()) %>% 
  pull(CostPerKm)
```
Average cost per Km is `r val`.

#### Driving {.tabset .tabset-fade .tabset-dropdown}

##### What is the averge range of the vehicle?

```{r echo = FALSE, message=FALSE, warning=FALSE}
df %>% 
  group_by(Temperature = cut(start_outside_temp, 5)) %>% 
  summarise(`Max Range` = max(range_start, na.rm = T) %>% round(0)) %>% 
  drop_na %>%
  mutate(Temperature = Temperature %>% 
           str_remove("\\(") %>% 
           str_remove("\\]") %>% 
           str_replace("\\,", " to "))
```

##### What is regenerative braking? How do the different brake modes (D, D1, D2, D3, B) effect the driving experience of the vehicle? 

The e-golf, like all other electric vehicles, uses regenerative braking, a technology that slows the vehicle down using the electric motor instead of the breaks. As the vehicle is slowed down, the extra energy is fed back into the motor and charges the vehicle battery. The brake modes determine how the car will slow down when coasting.

##### How fast is the e-golf?

Top speed: 150 km/h.

Time to accelerate from 0 - 100 km/h: 9.6 seconds

Instantaneous torque: 214 lb-ft (270 Nm)

##### How do the different drive modes effect the driving experience of the vehicle?

Normal:

Eco: Reduces fuel and air condtioning power consumption to increase range. Top speed is reduced to 115 km/h

Eco-Plus: Reduces fuel and air conditioning power consumption further than eco mode to maximize range. Top speed is reduced to 90 km/h

##### How does temperature affect the performance of the vehicle (i.e. range, charge speed, etc.)?

```{r echo = FALSE, message=FALSE, warning=FALSE}

df %>% 
  ggplot(aes(x = start_outside_temp, y = range_start)) + 
  geom_point(alpha = 0.15) + 
  geom_smooth(method = "lm", se = F) + 
  theme_minimal() + 
  theme(panel.grid = element_blank()) + 
  labs(x = "Temperature", y = "Range")

```

According to our data (shown above), the predicted range of the e-golf increases as temperature increases.

##### What is blue score?
Blue score is a feature that claims to train the owner to drive in a manner that improves economy and vehicle longevity.

```{r echo = FALSE, message=FALSE, warning=FALSE}
df %>% 
  group_by(cut(average_speed, 5)) %>% 
  summarise(mean = mean(blue_score, na.rm = T)) %>% kable()
```



